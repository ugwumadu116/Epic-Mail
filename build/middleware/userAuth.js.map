{"version":3,"sources":["../../api/middleware/userAuth.js"],"names":["dotenv","config","checkAuth","validate","req","res","next","token","headers","status","json","message","decoded","jwt","verify","process","env","SECRET","userData","err"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEAA,gBAAOC,MAAP;;AAEA,MAAMC,SAAN,CAAgB;AACd,eAAaC,QAAb,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,IAAhC,EAAsC;AACpC,QAAI;AACF,YAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,cAAZ,CAAd;;AACA,UAAI,CAACD,KAAL,EAAY;AACVF,QAAAA,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,UAAAA,OAAO,EAAE;AADU,SAArB;AAGD;;AACD,YAAMC,OAAO,GAAG,MAAMC,sBAAIC,MAAJ,CAAWP,KAAX,EAAkBQ,OAAO,CAACC,GAAR,CAAYC,MAA9B,CAAtB;;AACA,UAAIL,OAAJ,EAAa;AACXR,QAAAA,GAAG,CAACc,QAAJ,GAAeN,OAAf;AACAN,QAAAA,IAAI;AACL;AACF,KAZD,CAYE,OAAOa,GAAP,EAAY;AACZd,MAAAA,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,QAAAA,OAAO,EAAE;AADU,OAArB;AAGD;AACF;;AAnBa;;eAqBDT,S","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport dotenv from 'dotenv';\r\n\r\ndotenv.config();\r\n\r\nclass checkAuth {\r\n  static async validate(req, res, next) {\r\n    try {\r\n      const token = req.headers['x-auth-token'];\r\n      if (!token) {\r\n        res.status(401).json({\r\n          message: 'Access denied.No token provided',\r\n        });\r\n      }\r\n      const decoded = await jwt.verify(token, process.env.SECRET);\r\n      if (decoded) {\r\n        req.userData = decoded;\r\n        next();\r\n      }\r\n    } catch (err) {\r\n      res.status(400).json({\r\n        message: 'Unauthorized invalid token',\r\n      });\r\n    }\r\n  }\r\n}\r\nexport default checkAuth;\r\n"],"file":"userAuth.js"}